---
import { Image } from 'astro:assets'
import { getCollection } from 'astro:content'

import BaseLayout from '@/layouts/BaseLayout.astro'

import CardValue from '@/components/CardValue.astro'
import CardImpact from '@/components/CardImpact.astro'
import CardGoal from '@/components/CardGoal.astro'
import Code from '@/content/images/code.png'
import Button from '@/components/Button.astro'
import PostCard from '@/components/PostCard.astro'

import {
  CTA_LINKS,
  CommunityParteners,
  communityGoals,
  communityImpacts,
  communityValues,
} from '@/data'

import PossaCodeAfrica from '@/content/images/possacode-africa.png'
import TechoGroupeIcon1 from '@/content/images/techno-group-1.png'
import TechoGroupeIcon2 from '@/content/images/techno-group-2.png'
import PossaCodeMembers from '@/content/images/possacode-members.png'

const LastFourPosts = (await getCollection('blog'))
  .sort((a, b) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf())
  .slice(0, 4)
---

<BaseLayout>
  <section id="hero">
    <div class="flex min-h-screen w-full flex-col justify-between space-y-10">
      <div
        class="container mt-44 flex h-full flex-1 justify-center md:mt-0 md:items-center">
        <div class="flex flex-col items-center space-y-10">
          <h1
            class="text-center text-healding-1 font-bold uppercase text-white">
            Possa<span class="text-orange">Code</span>, une communauTé <br
              class="hidden md:block"
            /> des développeurs en Afrique
          </h1>
          <p class="max-w-3xl text-center tracking-wider text-white">
            © dynamique dédiée à la formation et à l'organisation d'événements
            de rencontre pour les développeurs en Afrique.
          </p>
        </div>
      </div>

      <div class="bg-slate-900/40 py-5">
        <ul
          role="list"
          class="container grid w-full grid-cols-2 gap-4 md:grid-cols-4">
          {
            communityGoals.map((goal, index) => (
              <CardGoal goal={goal} index={index} />
            ))
          }
        </ul>
      </div>
    </div>
  </section>

  <section id="notre-impact">
    <div class="container space-y-14 md:space-y-16">
      <div class="space-y-6">
        <h2 class="text-healding-2 font-semibold uppercase">Notre Impact</h2>
        <p class="max-w-4xl">
          « Le programme accroît la moyenne scolaire. Les élèves sont plus
          disciplinés dans leur travail scolaire, plus dynamiques et
          enthousiastes vis-à-vis de l’acquisition de connaissances nouvelles,
          et moins impulsifs. Il y a un impact positif du programme sur les
          aspirations des élèves, à la fois en matière d’études et de
          profession. »*
        </p>
      </div>

      <div class="flex flex-wrap items-center space-y-10 sm:space-y-0">
        <ul class="grid w-full grid-cols-2 gap-8 md:w-1/3">
          {communityImpacts.map((impact) => <CardImpact impact={impact} />)}
        </ul>

        <div class="relative flex w-full justify-center md:w-2/3">
          <div
            class="absolute -top-10 left-0 w-24 animate-ping-2 md:top-24 md:w-fit">
            <Image
              src={TechoGroupeIcon1}
              alt="logo technos"
              format="webp"
              quality="high"
              loading="eager"
            />
          </div>
          <div>
            <Image
              src={PossaCodeAfrica}
              alt="PossaCode in Africa"
              format="webp"
              quality="high"
              loading="eager"
            />
          </div>
          <div
            class="absolute -bottom-10 right-12 w-36 animate-ping-2 md:bottom-12 md:w-fit">
            <Image
              src={TechoGroupeIcon2}
              alt="icons technos"
              format="webp"
              quality="high"
              loading="eager"
            />
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="nos-valeurs">
    <div class="container relative space-y-12">
      <h2 class="text-healding-2 font-semibold">NOS VALEURS</h2>
      <p class="max-w-5xl">
        Odio numquam consequuntur repellendus beatae rerum sed et.
        Exercitationem rem et doloribus pariatur ex ad. Labore assumenda magnam
        quae. Debitis quos distinctio et. Ipsam a doloremque et iste officia
        accusamus est quae. Molestiae quis modi ratione.Odio numquam
        consequuntur repellendus beatae rerum sed et. Exercitationem rem et
        doloribus pariatur ex ad. Labore assumenda magnam quae. Debitis quos
        distinctio et. Ipsam a doloremque et iste officia accusamus est quae.
        Molestiae quis modi ratione.
      </p>

      <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {
          communityValues.map((value, index) => (
            <CardValue value={value} index={index} />
          ))
        }
      </div>

      <div
        aria-hidden="true"
        class="absolute right-36 top-0 -z-10 hidden opacity-70 lg:block">
        <Image src={Code} alt="Code filligram" loading="eager" format="png" />
      </div>
    </div>
  </section>

  <section id="agir-avec-nous">
    <div
      class="bg-[#1A2251] px-6 py-16 text-white lg:container lg:rounded-[49px] lg:p-28">
      <div class="relative flex flex-col items-center gap-10 lg:flex-row">
        <div class="relative flex-1 space-y-10 md:space-y-16">
          <h2
            class="relative inline-block text-healding-2 font-semibold text-white after:absolute after:bottom-0 after:left-0 after:h-1 after:w-1/2 after:bg-white">
            AGIR AVEC NOUS
          </h2>

          <div class="space-y-6">
            <p class="text-sm">
              Odio numquam consequuntur repellendus beatae rerum sed et.
              Exercitationem rem et doloribus pariatur ex ad. Labore assumenda
              magnam quae. Debitis quos distinctio et. Ipsam a doloremque et
              iste officia accusamus est quae. Molestiae quis modi ratione.
            </p>

            <p class="text-sm">
              Odio numquam consequuntur repellendus beatae rerum sed et.
              Exercitationem rem et doloribus pariatur ex ad. Labore assumenda
              magnam quae. Debitis quos distinctio et. Ipsam a doloremque et
              iste officia accusamus est quae. Molestiae quis modi ratione.
            </p>
          </div>

          <div class="relative z-[2] flex flex-wrap gap-5">
            {
              CTA_LINKS.map((link: (typeof CTA_LINKS)[0]) => (
                <Button {...link} />
              ))
            }
          </div>
        </div>

        <div class="relative mt-10 lg:mt-0">
          <Image
            src={PossaCodeMembers}
            loading="eager"
            format="webp"
            quality="high"
            alt="PossaCode  DevDay 2023"
            class="relative z-[2] w-11/12 max-w-[463px] md:w-full"
          />
          <div
            class="absolute -right-0.5 -top-5 h-full w-11/12 rounded-[20px] border-2 border-white md:-right-10 md:-top-10 md:w-full">
          </div>
        </div>

        <!-- Code fillgram hidden for screen reader-->
        <div aria-hidden="true" class="absolute -left-8 -top-4 hidden lg:block">
          <Image src={Code} alt="Code filligram" loading="eager" format="png" />
        </div>

        <div
          aria-hidden="true"
          class="absolute -bottom-4 left-12 hidden lg:block">
          <Image src={Code} alt="Code filligram" loading="eager" format="png" />
        </div>

        <div aria-hidden="true" class="absolute left-1/2 top-0 hidden lg:block">
          <Image src={Code} alt="Code filligram" loading="eager" format="png" />
        </div>

        <div
          aria-hidden="true"
          class="absolute -right-16 -top-16 hidden lg:block">
          <Image src={Code} alt="Code filligram" loading="eager" format="png" />
        </div>
      </div>
    </div>
  </section>

  <section id="notre-actualité">
    <div class="container space-y-20">
      <h2 class="text-healding-2 font-semibold">NOS ACTUALITÉS</h2>
      <div class="actuality w-full">
        <div
          class="max-w-[290px] space-y-4 rounded-[30px] bg-[#1A2251] px-[30px] py-[50px] text-white md:max-w-[607px] md:p-14">
          <h3 class="max-w-sm text-xl font-semibold uppercase md:text-4xl">
            Le programme accroît la moyenne scolaire.
          </h3>
          <p class="text-sm">
            « Le programme accroît la moyenne scolaire. Les élèves sont plus
            disciplinés dans leur travail scolaire, plus dynamiques et
            enthousiastes vis-à-vis de l’acquisition de connaissances nouvelles,
            et moins impulsifs. Il y a un impact positif du programme sur les
            aspirations des élèves, à la fois en matière d’études et de
            profession. »*
          </p>

          <Button
            href="/"
            text="Lire la suite"
            className="max-w-[142px] border-[0.7px] border-white/50 bg-white/15 transition hover:bg-white/20"
          />
        </div>
      </div>

      <div class="grid grid-cols-1 gap-10 md:grid-cols-2">
        {LastFourPosts.map((post) => <PostCard {...post} />)}
      </div>

      {
        LastFourPosts.length >= 2 && (
          <Button
            href="/blogs"
            text="Toutes les actualisés"
            className="mx-auto block w-fit"
          />
        )
      }
    </div>
  </section>

  <section id="sponsors" class="pb-10 md:pb-44">
    <div class="container space-y-14 md:space-y-20">
      <h2 class="text-healding-2 font-semibold uppercase">
        Partenaires <span class="text-orange">&</span> Sponsors
      </h2>

      <ul class="flex snap-x snap-mandatory gap-x-8 overflow-auto py-4">
        {
          CommunityParteners.map((parterner) => (
            <li class="flex-[0_0_200px] snap-center snap-always">
              <Image
                src={parterner}
                alt="logo partenaire de PossaCode"
                format="webp"
                quality="high"
                loading="lazy"
              />
            </li>
          ))
        }
      </ul>

      <div
        id="partenairs"
        class="space-y-4 rounded-[49px] p-8 text-white md:space-y-8 md:p-16">
        <h4 class="text-healding-2 font-bold">PossaCode</h4>
        <p class="max-w-prose text-sm">
          Odio numquam consequuntur repellendus beatae rerum sed et.
          Exercitationem rem et doloribus pariatur ex ad. Labore assumenda
          magnam quae. Debitis quos distinctio et. Ipsam a doloremque et iste
          officia accusamus est quae. Molestiae quis modi ratione.
        </p>

        <Button
          href="./devenir-membre"
          text="Dévenir membre"
          className="bg-white text-orange transition hover:bg-white/90"
        />
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  section:is(#hero) {
    background-image: linear-gradient(
        rgba(0, 0, 0, 0.703),
        rgba(0, 0, 0, 0.701)
      ),
      url('/src/content/images/hero-bg.png');

    @apply bg-cover bg-center bg-no-repeat;
    background-attachment: fixed;
  }

  section:is(#notre-actualité) .actuality {
    background-image: url('../content/images/actuality.png');
    @apply rounded-[30px] bg-[67%] bg-no-repeat p-3;
  }

  section #partenairs {
    background-image: url('../content/images/background-vector.png');
    @apply bg-cover bg-center bg-no-repeat;
  }

  section ul::-webkit-scrollbar {
    @apply h-0 max-w-[200px] cursor-pointer overflow-hidden rounded-full md:h-2;
  }

  section ul::-webkit-scrollbar-thumb {
    @apply rounded-full bg-gray-400;
  }
</style>
